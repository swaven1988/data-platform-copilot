upstream api_upstream {
  server copilot-api-dev:8001;
}

server {
  listen 80;

  location /api/ {
    proxy_pass http://api_upstream/api/;
    proxy_set_header Host $host;

    proxy_set_header Authorization $http_authorization;
    proxy_set_header X-Forwarded-Authorization $http_authorization;
  }

  # (optional) keep health direct
  location /health {
    proxy_pass http://api_upstream/health;
  }
}
